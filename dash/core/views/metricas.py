from rest_framework import viewsets, status
from rest_framework.response import Response
from rest_framework.decorators import action
from dash.core.repository.metricas import Metricas


class MetricasViewSet(viewsets.ViewSet):
    ''' EndPoint para Metricas'''

    @action(detail=False, methods=['get'], url_path='severity_sum')
    def severity_sum(self, request):
        ''' Soma as os tipos de gravidades da tabela asset_vulnerability'''

        if request.method == 'GET':
            metricas = Metricas()
            response = metricas.severity_sum()

            return Response(data=response, status=status.HTTP_200_OK)